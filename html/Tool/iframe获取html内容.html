<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>css选择器</title>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<meta http-equiv="Content-Language" content="zh-cn" />
	<style>
	body{margin:0;padding:0;padding-left: 20px;}
	</style>
</head>
<body>
<div class="post_body">


            同域或跨子域读写操作&nbsp;iframe&nbsp;里的内容<br>
<br>
父页面读写操作子页面：<br>
<br>
<div><div class="syntaxhighlighter  html" id="highlighter_330258"><div class="toolbar"><span>XML/HTML code</span><span title="复制" class="clipboardCopyBtn"><div class="d_clip_button"><embed width="16" height="16" wmode="transparent" flashvars="id=1&amp;width=16&amp;height=16" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" allowfullscreen="false" allowscriptaccess="always" name="ZeroClipboardMovie_1" bgcolor="#ffffff" quality="best" menu="false" loop="false" src="/assets/ZeroClipboard.swf" id="ZeroClipboardMovie_1"></div></span><span class="clipboardWindowBtn"><a title="源码" href="#clipboardWindow">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="html plain">&lt;</code><code class="html keyword">iframe</code>&nbsp;<code class="html color1">id</code><code class="html plain">=</code><code class="html string">"test-iframe"</code>&nbsp;<code class="html color1">name</code><code class="html plain">=</code><code class="html string">"test-iframe"</code>&nbsp;<code class="html color1">src</code><code class="html plain">=</code><code class="html string">"child.html"</code>&nbsp;<code class="html color1">scrolling</code><code class="html plain">=</code><code class="html string">"no"</code>&nbsp;<code class="html color1">frameborder</code><code class="html plain">=</code><code class="html string">"0"</code><code class="html plain">&gt;&lt;/</code><code class="html keyword">iframe</code><code class="html plain">&gt;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="html plain">&lt;</code><code class="html keyword">script</code><code class="html plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="html plain">window.onload&nbsp;=&nbsp;function&nbsp;()&nbsp;{</code></div><div class="line number5 index4 alt2"><code class="html spaces">&nbsp;&nbsp;</code><code class="html plain">/*</code></div><div class="line number6 index5 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;</code><code class="html plain">*&nbsp;&nbsp;下面两种获取节点内容的方式都可以。</code></div><div class="line number7 index6 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;</code><code class="html plain">*&nbsp;&nbsp;由于&nbsp;IE6,&nbsp;IE7&nbsp;不支持&nbsp;contentDocument&nbsp;属性，所以此处用了通用的</code></div><div class="line number8 index7 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;</code><code class="html plain">*&nbsp;&nbsp;window.frames["iframe&nbsp;Name"]&nbsp;or&nbsp;window.frames[index]</code></div><div class="line number9 index8 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;</code><code class="html plain">*/</code></div><div class="line number10 index9 alt1"><code class="html spaces">&nbsp;&nbsp;</code><code class="html plain">var&nbsp;d&nbsp;=&nbsp;window.frames["test-iframe"].document;</code></div><div class="line number11 index10 alt2"><code class="html spaces">&nbsp;&nbsp;</code><code class="html plain">d.getElementsByTagName('h1')[0].innerHTML&nbsp;=&nbsp;'pp';</code></div><div class="line number12 index11 alt1"><code class="html spaces">&nbsp;&nbsp;</code><code class="html plain">alert(d.getElementsByTagName('h1')[0].firstChild.data);</code></div><div class="line number13 index12 alt2"><code class="html plain">}</code></div><div class="line number14 index13 alt1"><code class="html plain">&lt;/</code><code class="html keyword">script</code><code class="html plain">&gt;</code></div></div></td></tr></tbody></table></div></div><br>
注：在请务必通过&nbsp;window.onload&nbsp;方法访问&nbsp;iframe&nbsp;中的节点，否则浏览器会提示错误-拒绝访问。在&nbsp;IE8,&nbsp;Firefox3.6,&nbsp;Opera11&nbsp;下在&nbsp;DOMReady&nbsp;时也可以访问&nbsp;iframe&nbsp;中的节点。<br>
<br>
子页面读写操作父页面：<br>
<br>
&lt;script&gt;<br>
&nbsp;&nbsp;parent.document.getElementsByTagName('h1')[0].innerHTML&nbsp;=&nbsp;'pp';<br>
&nbsp;&nbsp;alert(parent.document.getElementsByTagName('h1')[0].firstChild.data);<br>
&lt;/script&gt;<br>
小结：<br>
<br>
1&nbsp;测试通过&nbsp;IE6,&nbsp;IE7,&nbsp;IE8,&nbsp;Firefox2.0,&nbsp;Firefox3.0,&nbsp;Firefox3.6,&nbsp;Chrome8,&nbsp;Opera11,&nbsp;Safari5.<br>
2&nbsp;查阅资料得出&nbsp;document.getElementById(‘id&nbsp;name’).contentDocument&nbsp;全等于&nbsp;window.frames["iframe&nbsp;Name"].document.<br>
3&nbsp;跨子域时，需要在父页面和子页面&nbsp;JS&nbsp;中分别加上&nbsp;document.domain&nbsp;=&nbsp;'xxx.com';<br>
跨域操作&nbsp;iframe&nbsp;里内容<br>
<br>
当两个网页所在域不同时,要实现数据的互相调用，只能通过&nbsp;JS&nbsp;改变&nbsp;location&nbsp;对象的&nbsp;hash&nbsp;属性的值来做到互相通信。<br>
<br>
父页面：<br>
<div><div class="syntaxhighlighter  html" id="highlighter_612635"><div class="toolbar"><span>XML/HTML code</span><span title="复制" class="clipboardCopyBtn"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a title="源码" href="#clipboardWindow">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="html plain">&lt;</code><code class="html keyword">iframe</code>&nbsp;<code class="html color1">id</code><code class="html plain">=</code><code class="html string">"test-iframe"</code>&nbsp;<code class="html color1">src</code><code class="html plain">=</code><code class="html string">"http://www.yyy.com/child.html"</code>&nbsp;<code class="html color1">scrolling</code><code class="html plain">=</code><code class="html string">"no"</code>&nbsp;<code class="html color1">frameborder</code><code class="html plain">=</code><code class="html string">"0"</code><code class="html plain">&gt;&lt;/</code><code class="html keyword">iframe</code><code class="html plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="html plain">&lt;</code><code class="html keyword">input</code>&nbsp;<code class="html color1">type</code><code class="html plain">=</code><code class="html string">"button"</code>&nbsp;<code class="html color1">value</code><code class="html plain">=</code><code class="html string">"send"</code>&nbsp;<code class="html color1">onclick</code><code class="html plain">=</code><code class="html string">"sendRequest()"</code>&nbsp;<code class="html plain">/&gt;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="html plain">&lt;</code><code class="html keyword">script</code><code class="html plain">&gt;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="html plain">function&nbsp;sendRequest()&nbsp;{</code></div><div class="line number7 index6 alt2"><code class="html spaces">&nbsp;&nbsp;</code><code class="html plain">document.getElementById('test-iframe').src&nbsp;+=&nbsp;'#a';</code></div><div class="line number8 index7 alt1"><code class="html plain">}</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="html plain">var&nbsp;interval&nbsp;=&nbsp;window.setInterval(function(){</code></div><div class="line number11 index10 alt2"><code class="html spaces">&nbsp;&nbsp;</code><code class="html plain">if(location.hash)&nbsp;{</code></div><div class="line number12 index11 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">alert(location.hash);</code></div><div class="line number13 index12 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">window.clearInterval(interval);</code></div><div class="line number14 index13 alt1"><code class="html spaces">&nbsp;&nbsp;</code><code class="html plain">}</code></div><div class="line number15 index14 alt2"><code class="html plain">},1000);</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="html plain">&lt;/</code><code class="html keyword">script</code><code class="html plain">&gt;</code></div><div class="line number18 index17 alt1"><code class="html plain">子页面：</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="html plain">&lt;</code><code class="html keyword">h1</code><code class="html plain">&gt;RRRRRR&lt;/</code><code class="html keyword">h1</code><code class="html plain">&gt;</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="html plain">&lt;</code><code class="html keyword">script</code><code class="html plain">&gt;</code></div><div class="line number23 index22 alt2"><code class="html plain">var&nbsp;url&nbsp;=&nbsp;'http://www.xxx.com/father.html';</code></div><div class="line number24 index23 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">oldHash&nbsp;=&nbsp;self.location.hash,</code></div><div class="line number25 index24 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">newHash,</code></div><div class="line number26 index25 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">interval&nbsp;=&nbsp;window.setInterval(function(){</code></div><div class="line number27 index26 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">newHash&nbsp;=&nbsp;self.location.hash;</code></div><div class="line number28 index27 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">if(oldHash&nbsp;!=&nbsp;self.location.hash)&nbsp;{</code></div><div class="line number29 index28 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">document.getElementsByTagName('h1')[0].innerHTML&nbsp;=&nbsp;'pp';</code></div><div class="line number30 index29 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">//alert(parent.location.href);&nbsp;//去掉这个注释，浏览器会提示无权限</code></div><div class="line number31 index30 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">parent.location.href&nbsp;=&nbsp;url&nbsp;+&nbsp;'#b';</code></div><div class="line number32 index31 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">window.clearInterval(interval);</code></div><div class="line number33 index32 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">}</code></div><div class="line number34 index33 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">},500);</code></div><div class="line number35 index34 alt2"><code class="html plain">&lt;/</code><code class="html keyword">script</code><code class="html plain">&gt;</code></div></div></td></tr></tbody></table></div></div><br>
小结：<br>
<br>
1&nbsp;经测试&nbsp;IE6,&nbsp;IE7,&nbsp;IE8,&nbsp;Firefox2.0,&nbsp;Firefox3.0,&nbsp;Firefox3.6,&nbsp;Chrome8,&nbsp;Opera11,&nbsp;Safari5,&nbsp;除&nbsp;IE6,&nbsp;IE7&nbsp;外只要改变&nbsp;hash&nbsp;就会记录在浏览器&nbsp;history&nbsp;中。<br>
2&nbsp;我有试图在子页面用&nbsp;parent.location.replace&nbsp;的方法来避免父页面向服务器发送请求而进行跳转，这样理论上浏览器就不会记录历史，但未能奏效。<br>
2&nbsp;子页面无权读取父页面的&nbsp;url,&nbsp;但可以对父页面的&nbsp;url&nbsp;进行写操作，所以跨域操作时，要提前得知父页面的url

        </div>
</body>
</html>